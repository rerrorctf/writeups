https://ctftime.org/event/2651

# Baby RSA 1 (crypto)

## Analysis

We can see from the following code that we are given two values `x` and `y` which are algebraically related to `p` and `q`:

```python
a = randint(0, 2**100)
b = randint(0, 2**100)
c = randint(0, 2**100)
d = randint(0, 2**100)

x = a * p + b * q
y = c * p + d * q
```

## Solution

1) Use z3 to solve for `p` and `q` given the constraints
2) Use `p` and `q` to compute `phi` and `d`
3) Decrypt the ciphertext with `d`

```python
#!/usr/bin/env python3

from z3 import *

n = 82012538447359821165849738352756467719053530066892750177578020351019136006996881441650616631012602654920370573185549134046659875914860421394782338722082599261391182262036434549525388081948429632803770833590739702562845306267418403878169267641023564108136843672261999376998284926318313315387819024961709097101
e = 65537
ct = 16978597269030388872549064541934623430749704732655891928833779185083334396093332647023718343748730349576361193985691953617733288330780060179716905267988202710452028943623598185277149645724247199640730959820455032298145782015884558972868277752456856802145299858618876838286795962548300080924547387662096543717

a = 149738867837230590596162146900
b = 743799113257239690478459408953
c = 351498883480247386367558572595
d = 1175770398223262147164171561358

x = 6836728736678282915469852947219518538837808913380425472016857154639492051766923345186030197640091719641785981050969319578519968972834509899732176840511342124020344870655741074618585883
y = 12203451977234755811396526665700561863946871005728263879373008871704520841041885029745864562375412192520795388389509063064717933869698154304534842876137996238014648925041725231457010083

p = Int("p")
q = Int("q")

s = Solver()

s.add(p > 0, q > 0)
s.add(p < n, q < n)
s.add(x == (a * p + b * q))
s.add(y == (c * p + d * q))

s.check()
model = s.model()

p = int(str(model[p]))
print(f"{p = }") # 12162334930199885688769183795689969592410185555679120917249758283834302412858357859449128842077327318557896169674210867635116014075086788310254623347673691

q = int(str(model[q]))
print(f"{q = }") # 6743157372168500256063482560637365574152487940325590507177860664787954181316130485116121883062542995102725009460890756991543596608364763570502665225651511

assert((p * q) == n)

phi = (p - 1) * (q - 1)
d = pow(e, -1, phi)
m = pow(ct, d, n)

flag = m.to_bytes(length=(m.bit_length() + 7) // 8, byteorder="big")
print(flag.decode()) # DawgCTF{wh0_s41d_m4th_15_us3l3ss?}
```

## Flag
`DawgCTF{wh0_s41d_m4th_15_us3l3ss?}`

smiley 2025/04/19
